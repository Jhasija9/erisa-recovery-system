{% extends 'claims/base.html' %}
{% load currency_filters %}

{% block content %}
<div class="bg-white min-h-screen">
    <!-- B) Filters Row (Desktop Only) - Full Width Like Claims Listing -->
    <div class="px-6 py-6 hidden md:block">
        <div class="bg-white rounded-xl shadow-sm ring-1 ring-gray-200/60 p-6">
            <div class="text-center mb-6">
                <!-- <h3 class="text-xl font-bold text-blue-900 mb-2">Dashboard Filters</h3> -->
                <!-- <p class="text-sm text-blue-700">Filter your data by date range, insurer, and status</p> -->
            </div>
            
            <div class="flex flex-wrap gap-6 items-end justify-center">
                <div class="min-w-56">
                    <label for="from_date" class="block text-base font-semibold text-gray-700 mb-3">From Date</label>
                    <input 
                        type="date" 
                        id="from_date" 
                        name="from_date" 
                        value="{{ current_filters.from_date }}"
                        hx-get="{% url 'claims:dashboard' %}"
                        hx-target="#dashboard-content"
                        hx-trigger="change"
                        hx-include="[name='to_date'], [name='insurer'], [name='status']"
                        hx-push-url="true"
                        class="block w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 shadow-sm bg-white"
                    >
                </div>
                
                <div class="min-w-56">
                    <label for="to_date" class="block text-base font-semibold text-gray-700 mb-3">To Date</label>
                    <input 
                        type="date" 
                        id="to_date" 
                        name="to_date" 
                        value="{{ current_filters.to_date }}"
                        hx-get="{% url 'claims:dashboard' %}"
                        hx-target="#dashboard-content"
                        hx-trigger="change"
                        hx-include="[name='from_date'], [name='insurer'], [name='status']"
                        hx-push-url="true"
                        class="block w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 shadow-sm bg-white"
                    >
                </div>
                
                <div class="min-w-56">
                    <label for="insurer" class="block text-base font-semibold text-gray-700 mb-3">Insurer</label>
                    <div class="relative">
                        <select 
                            id="insurer" 
                            name="insurer" 
                            hx-get="{% url 'claims:dashboard' %}"
                            hx-target="#dashboard-content"
                            hx-trigger="change"
                            hx-include="[name='from_date'], [name='to_date'], [name='status']"
                            hx-push-url="true"
                            class="block w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 shadow-sm bg-white appearance-none"
                        >
                            <option value="">All Insurers</option>
                            {% for insurer in insurers %}
                                <option value="{{ insurer }}" {% if current_filters.insurer == insurer %}selected{% endif %}>{{ insurer }}</option>
                            {% endfor %}
                        </select>
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="min-w-56">
                    <label for="status" class="block text-base font-semibold text-gray-700 mb-3">Status</label>
                    <div class="relative">
                        <select 
                            id="status" 
                            name="status" 
                            hx-get="{% url 'claims:dashboard' %}"
                            hx-target="#dashboard-content"
                            hx-trigger="change"
                            hx-include="[name='from_date'], [name='to_date'], [name='insurer']"
                            hx-push-url="true"
                            class="block w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 shadow-sm bg-white appearance-none"
                        >
                            {% for status in statuses %}
                                <option value="{{ status|lower }}" {% if current_filters.status == status|lower %}selected{% endif %}>{{ status }}</option>
                            {% endfor %}
                        </select>
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                            <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <div class="flex gap-4">
                    <a 
                        href="{% url 'claims:dashboard' %}" 
                        class="px-8 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 font-semibold shadow-sm flex items-center gap-2"
                    >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        Clear All
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Content Container -->
    <div id="dashboard-content">
        {% include 'claims/partials/dashboard_content.html' %}
    </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}
